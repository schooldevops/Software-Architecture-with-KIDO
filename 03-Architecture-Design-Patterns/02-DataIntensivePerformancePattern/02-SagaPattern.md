# Saga Pattern

SAGA 패턴은 여러 서비스 간에 발생하는 분산 트랜잭션을 관리하기 위한 패턴입니다. 하나의 트랜잭션이 여러 단계로 구성되어 있을 때, 각 단계마다 필요한 모든 작업을 수행하고, 모든 작업이 성공했을 때만 커밋하는 방식으로 트랜잭션을 처리합니다. 이를 통해 전체 트랜잭션을 원자적으로 처리하고, 일관성을 유지할 수 있습니다.

대표적인 예로는 예약 시스템이나 주문 처리 시스템이 있습니다. 이러한 시스템에서는 여러 서비스 간의 트랜잭션이 발생하며, 예를 들어 고객이 여행 상품을 예약하면 여러 서비스 간에 예약 정보, 결제 정보, 호텔 예약 정보 등이 주고받아지게 됩니다. 이때 SAGA 패턴을 적용하면 예약, 결제, 호텔 예약 등 각각의 단계에서 문제가 발생했을 때 롤백을 수행하고, 모든 작업이 성공적으로 완료될 때만 커밋을 수행하여 전체 트랜잭션의 일관성을 유지할 수 있습니다.

SAGA 패턴의 주요 베스트 프랙티스는 다음과 같습니다.

모든 단계에서 롤백이 가능하도록 해야 합니다. 이를 통해 문제가 발생했을 때 이전 단계로 돌아갈 수 있습니다.
각각의 단계는 최대한 독립적이어야 합니다. 이를 통해 단계 간의 영향을 최소화하고, 병목 현상을 줄일 수 있습니다.
각각의 단계는 선형적으로 실행되어야 합니다. 이를 통해 트랜잭션 처리의 순서를 보장하고, 일관성을 유지할 수 있습니다.
최종 커밋이 수행될 때까지는 변경 사항이 적용되지 않아야 합니다. 이를 통해 전체 트랜잭션의 원자성을 유지할 수 있습니다.

--------------------------
SAGA 패턴은 분산 트랜잭션을 처리하는 패턴 중 하나입니다. 여러 서비스 간의 트랜잭션 처리를 위해 사용됩니다. SAGA는 각 단계별로 커밋과 롤백을 수행하는 일련의 트랜잭션을 순차적으로 실행하면서 트랜잭션 처리를 보장합니다.

대표적인 예로는 여러 서비스 간의 주문 처리 시스템이 있습니다. 주문 생성, 결제, 배송 등 각각의 서비스는 별도의 트랜잭션 처리가 필요합니다. 이때 SAGA 패턴을 적용하면 전체 주문 처리 과정을 안전하게 보장할 수 있습니다.

SAGA 패턴의 주요 베스트 프랙티스는 다음과 같습니다.

각 단계별로 커밋과 롤백을 수행할 수 있어야 합니다.
각 단계는 이전 단계의 처리 결과를 확인하고, 다음 단계로 진행할지 결정합니다.
각 서비스는 자신의 트랜잭션 처리 결과를 다른 서비스에게 전파합니다.
각 서비스는 전파된 결과를 바탕으로 자신의 커밋 또는 롤백을 수행합니다.
SAGA에서 중단된 서비스는 롤백 처리를 수행해야 합니다.
SAGA 패턴은 복잡한 분산 트랜잭션 처리를 보장하기 위해 사용됩니다. 하지만 여러 서비스 간의 통신이 많아지고, 롤백 시에도 데이터 일관성을 유지하기 위해 추가적인 구현이 필요해지는 단점이 있습니다.

